---
title: ‰∏Ä‰∏™ÊâπÈáèÈáçÂëΩÂêçÂ∑•ÂÖ∑‚Äî‚ÄîRenamer
date: 2025-12-19 10:30:14
tags: ÂÆûÁî®Â∑•ÂÖ∑
categories: ÂÆûÁî®Â∑•ÂÖ∑
---
<!-- more -->
# Hello ÊúãÂèã‰ª¨ÔºÅ

‰ªäÂ§©Â∏¶Êù•‰∏Ä‰∏™ÂÆûÁî®ÁöÑÂ∑•ÂÖ∑‚Äî‚Äî**Renamer**

‰ªìÂ∫ìÈìæÊé•

[![Repo Name](https://github-readme-stats.vercel.app/api/pin/?username=lyc-28&repo=Renamer)](https://github.com/lyc-28/Renamer)

‰∏ãÈù¢ÊòØÊú¨Á®ãÂ∫èÁöÑ‰ΩøÁî®ÊïôÁ®ãÔºà‰∏ãÊñπÈôÑÊúâÊ∫êÁ†ÅÔºâÔºö

# ReNamer ÊâπÈáèÈáçÂëΩÂêçÂ∑•ÂÖ∑ - ‰ΩøÁî®ËØ¥Êòé‰π¶

**ReNamer** ÊòØ‰∏ÄÊ¨æËΩªÈáèÁ∫ß„ÄÅÂäüËÉΩÂº∫Â§ßÁöÑÊñá‰ª∂ÊâπÈáèÈáçÂëΩÂêçÂ∑•ÂÖ∑„ÄÇÂÆÉÈááÁî®‚ÄúÊ®°ÂùóÂåñËßÑÂàô‚ÄùÁöÑËÆæËÆ°ÁêÜÂøµÔºåÂÖÅËÆ∏Áî®Êà∑ÈÄöËøáÁªÑÂêà‰∏çÂêåÁöÑÂ§ÑÁêÜËßÑÂàôÔºàÂ¶ÇÊèíÂÖ•„ÄÅÂà†Èô§„ÄÅÊõøÊç¢„ÄÅÂ∫èÂàóÂåñÁ≠âÔºâÔºåÂØπÂ§ßÈáèÊñá‰ª∂ËøõË°åÂø´ÈÄü„ÄÅÂÆâÂÖ®ÁöÑÊîπÂêçÊìç‰Ωú„ÄÇ

---

## ÁõÆÂΩï
1. [ÁïåÈù¢Ê¶ÇËßà](#1-ÁïåÈù¢Ê¶ÇËßà)
2. [Âø´ÈÄüÂºÄÂßã](#2-Âø´ÈÄüÂºÄÂßãÊìç‰ΩúÊµÅÁ®ã)
3. [ËßÑÂàôËØ¶Ëß£](#3-ËßÑÂàôËØ¶Ëß£)
4. [È´òÁ∫ßÂäüËÉΩ‰∏éÊäÄÂ∑ß](#4-È´òÁ∫ßÂäüËÉΩ‰∏éÊäÄÂ∑ß)
5. [Â∏∏ËßÅÈóÆÈ¢ò‰∏éÊ≥®ÊÑè‰∫ãÈ°π](#5-Â∏∏ËßÅÈóÆÈ¢ò‰∏éÊ≥®ÊÑè‰∫ãÈ°π)

---

## 1. ÁïåÈù¢Ê¶ÇËßà

![ÁïåÈù¢](../img/Renamer.png)

ËΩØ‰ª∂‰∏ªÁïåÈù¢ÂàÜ‰∏∫‰∏ä‰∏ã‰∏§‰∏™‰∏ªË¶ÅÂå∫ÂüüÔºåÁî±‰∏≠Èó¥ÁöÑÂàÜÈöîÊù°ÈöîÂºÄÔºàÂèØ‰∏ä‰∏ãÊãñÂä®Ë∞ÉÊï¥È´òÂ∫¶ÔºâÔºö

*   **È°∂ÈÉ®Â∑•ÂÖ∑Ê†è**ÔºöÂåÖÂê´Ê∑ªÂä†Êñá‰ª∂„ÄÅÂà∑Êñ∞È¢ÑËßà„ÄÅÊâßË°åÈáçÂëΩÂêçÁ≠âÂ∏∏Áî®ÂäüËÉΩÊåâÈíÆ„ÄÇ
*   **‰∏äÂçäÈÉ®ÂàÜÔºàËßÑÂàôÂå∫Ôºâ**ÔºöÊòæÁ§∫ÂΩìÂâçËÆæÂÆöÁöÑÊâÄÊúâÈáçÂëΩÂêçËßÑÂàô„ÄÇ
    *   ÊîØÊåÅÊ∑ªÂä†„ÄÅÁßªÈô§„ÄÅ‰∏ä‰∏ãÁßªÂä®ËßÑÂàô„ÄÇ
    *   ËßÑÂàô‰ªé‰∏äÂà∞‰∏ã‰æùÊ¨°ÊâßË°å„ÄÇ
*   **‰∏ãÂçäÈÉ®ÂàÜÔºàÊñá‰ª∂Âå∫Ôºâ**ÔºöÊòæÁ§∫ÂæÖÂ§ÑÁêÜÁöÑÊñá‰ª∂ÂàóË°®„ÄÇ
    *   **Áä∂ÊÄÅ**ÔºöÊòæÁ§∫Êñá‰ª∂ÂΩìÂâçÁöÑÊÉÖÂÜµÔºàOK„ÄÅÂÜ≤Á™Å„ÄÅÂ∑≤Â≠òÂú®Á≠âÔºâ„ÄÇ
    *   **Êñ∞ÂêçÁß∞**ÔºöÂÆûÊó∂È¢ÑËßàÂ∫îÁî®ËßÑÂàôÂêéÁöÑÊñá‰ª∂ÂêçÔºàËìùËâ≤Ë°®Á§∫ÊúâÂèòÂåñÔºåÁ∫¢Ëâ≤Ë°®Á§∫ÊúâÈîôËØØÔºâ„ÄÇ
    *   **ÂéüÂêçÁß∞/Ë∑ØÂæÑ**ÔºöÊñá‰ª∂ÁöÑÂéüÂßã‰ø°ÊÅØ„ÄÇ
*   **Â∫ïÈÉ®Áä∂ÊÄÅÊ†è**ÔºöÊòæÁ§∫ÂΩìÂâçÂä†ËΩΩÁöÑÊñá‰ª∂ÊÄªÊï∞„ÄÇ

---

## 2. Âø´ÈÄüÂºÄÂßãÔºàÊìç‰ΩúÊµÅÁ®ãÔºâ

Âè™ÈúÄÁÆÄÂçïÁöÑÂõõÊ≠•Âç≥ÂèØÂÆåÊàêÊâπÈáèÈáçÂëΩÂêçÔºö

### Á¨¨‰∏ÄÊ≠•ÔºöÂØºÂÖ•Êñá‰ª∂
Êúâ‰∏§ÁßçÊñπÂºèÂ∞ÜÊñá‰ª∂Ê∑ªÂä†Âà∞ËΩØ‰ª∂‰∏≠Ôºö
1.  **ÁÇπÂáªÊåâÈíÆ**ÔºöÁÇπÂáªÂ∑•ÂÖ∑Ê†èÂ∑¶‰æßÁöÑ **üìÑ Ê∑ªÂä†Êñá‰ª∂** Êàñ **üìÇ Ê∑ªÂä†Êñá‰ª∂Â§π** ÂõæÊ†á„ÄÇ
2.  **ÊãñÊãΩÊìç‰Ωú**ÔºöÁõ¥Êé•‰ªéÊñá‰ª∂Â§π‰∏≠ÈÄâ‰∏≠Â§ö‰∏™Êñá‰ª∂ÔºåÊãñÂÖ•ËΩØ‰ª∂‰∏ãÊñπÁöÑ‚ÄúÊñá‰ª∂ÂàóË°®‚ÄùÂå∫ÂüüÔºàÁ©∫ÁôΩÂ§ÑÊòæÁ§∫‚ÄúÊãñÊãΩÊñá‰ª∂Âà∞Ê≠§Â§Ñ‚ÄùÔºâ„ÄÇ

### Á¨¨‰∫åÊ≠•ÔºöÊ∑ªÂä†ËßÑÂàô
ÁÇπÂáªËßÑÂàôÂå∫Ôºà‰∏äÂçäÈÉ®ÂàÜÔºâÂ∑¶‰∏äËßíÁöÑ **‚úö Ê∑ªÂä†** ÊåâÈíÆÔºåÂºπÂá∫ËßÑÂàôÈÖçÁΩÆÁ™óÂè£„ÄÇ
1.  Âú®Â∑¶‰æßÂàóË°®ÈÄâÊã©ËßÑÂàôÁ±ªÂûãÔºàÂ¶ÇÔºöÊèíÂÖ•„ÄÅÊõøÊç¢„ÄÅÂ∫èÂàóÂåñÁ≠âÔºâ„ÄÇ
2.  Âú®Âè≥‰æßËÆæÁΩÆÂÖ∑‰ΩìÂèÇÊï∞„ÄÇ
3.  ÁÇπÂáª **‚ûï Ê∑ªÂä†** Á°ÆËÆ§„ÄÇ
    *   *Ê≥®ÔºöÊÇ®ÂèØ‰ª•Ê∑ªÂä†Â§öÊù°ËßÑÂàôÔºåËΩØ‰ª∂‰ºöÊåâÈ°∫Â∫è‰æùÊ¨°Â§ÑÁêÜ„ÄÇ*

### Á¨¨‰∏âÊ≠•ÔºöÈ¢ÑËßà‰∏éÊ£ÄÊü•
Ê∑ªÂä†ËßÑÂàôÂêéÔºå‰∏ãÊñπÁöÑÊñá‰ª∂ÂàóË°®‰ºöËá™Âä®Âà∑Êñ∞Ôºö
*   ËßÇÂØü **‚ÄúÊñ∞ÂêçÁß∞‚Äù** ÂàóÔºöËøôÊòØÊîπÂêçÂêéÁöÑÈ¢ÑÊúüÁªìÊûú„ÄÇ
*   **ËìùËâ≤ÊñáÂ≠ó**ÔºöË°®Á§∫Êñá‰ª∂ÂêçÂ∞ÜÂèëÁîüÊîπÂèò„ÄÇ
*   **ÈªëËâ≤ÊñáÂ≠ó**ÔºöË°®Á§∫Êñá‰ª∂ÂêçÊú™ÂèëÁîüÂèòÂåñÔºàËßÑÂàôÊú™ÂëΩ‰∏≠Ôºâ„ÄÇ
*   **Á∫¢Ëâ≤ÊñáÂ≠ó/Áä∂ÊÄÅ**Ôºö
    *   `ÂÜ≤Á™Å`ÔºöË°®Á§∫Â§ö‰∏™Êñá‰ª∂ÊîπÂêçÂêéÂèòÊàê‰∫ÜÂêå‰∏Ä‰∏™ÂêçÂ≠ó„ÄÇ
    *   `Â∑≤Â≠òÂú®`ÔºöË°®Á§∫ÁõÆÊ†áÊñá‰ª∂Â§πÈáåÂ∑≤ÁªèÊúâ‰∏Ä‰∏™ÂêåÂêçÊñá‰ª∂„ÄÇ
    *   *Ê≥®ÊÑèÔºöÂ¶ÇÊûúÊúâÁ∫¢Ëâ≤Áä∂ÊÄÅÔºåËØ∑‰øÆÊîπËßÑÂàôÁõ¥Âà∞Âèò‰∏∫Ê≠£Â∏∏ÔºåÂê¶ÂàôÊó†Ê≥ïÊâßË°å„ÄÇ*

### Á¨¨‰∏âÊ≠•ÔºöÊâßË°åÈáçÂëΩÂêç
Á°ÆËÆ§È¢ÑËßàÊó†ËØØÂêéÔºåÁÇπÂáªÂ∑•ÂÖ∑Ê†èÊúÄÂè≥‰æßÁöÑ **‚úÖ ÈáçÂëΩÂêç** ÊåâÈíÆ„ÄÇ
*   Á≥ªÁªü‰ºöÂºπÁ™óÊèêÁ§∫ÊàêÂäüÈáçÂëΩÂêçÁöÑÊñá‰ª∂Êï∞Èáè„ÄÇ
*   ÂÆåÊàêÂêéÔºåÂàóË°®‰∏≠ÁöÑ‚ÄúÂéüÂêçÁß∞‚Äù‰ºöËá™Âä®Êõ¥Êñ∞‰∏∫ÊúÄÊñ∞ÂêçÁß∞„ÄÇ

---

## 3. ËßÑÂàôËØ¶Ëß£

ËΩØ‰ª∂ÂÜÖÁΩÆ‰∫Ü 7 ÁßçÊ†∏ÂøÉËßÑÂàôÔºåÁÅµÊ¥ªÁªÑÂêàÂèØÊª°Ë∂≥ÁªùÂ§ßÂ§öÊï∞ÈúÄÊ±Ç„ÄÇ

### 3.1 ÊèíÂÖ• (Insert)
Âú®Êñá‰ª∂ÂêçÁöÑÊåáÂÆö‰ΩçÁΩÆÂä†ÂÖ•ÊñáÂ≠ó„ÄÇ
*   **‰ΩçÁΩÆ**Ôºö
    *   `ÂâçÁºÄ`ÔºöÂä†Âú®Êñá‰ª∂ÂêçÁöÑÊúÄÂºÄÂ§¥„ÄÇ
    *   `ÂêéÁºÄ`ÔºöÂä†Âú®Êñá‰ª∂ÂêçÁöÑÊú´Â∞æÔºàÊâ©Â±ïÂêç‰πãÂâçÔºâ„ÄÇ
    *   `ÊåáÂÆö‰ΩçÁΩÆ`Ôºö‰ªéÁ¨¨ N ‰∏™Â≠óÁ¨¶ÂêéÊèíÂÖ•„ÄÇ
*   **ÂøΩÁï•Êâ©Â±ïÂêç**ÔºöÂãæÈÄâÂêéÔºåÂêéÁºÄÂíå‰ΩçÁΩÆËÆ°ÁÆó‰∏çÂåÖÂê´ `.jpg` Á≠âÂêéÁºÄ„ÄÇ

### 3.2 Âà†Èô§ (Delete)
Âà†Èô§Êñá‰ª∂Âêç‰∏≠ÊåáÂÆöÂå∫Èó¥ÁöÑÂ≠óÁ¨¶„ÄÇ
*   **Ëµ∑Âßã‰ΩçÁΩÆ**Ôºö‰ªéÁ¨¨Âá†‰∏™Â≠óÁ¨¶ÂºÄÂßãÂà†Ôºà1 ‰ª£Ë°®Á¨¨ 1 ‰∏™Â≠óÔºâ„ÄÇ
*   **Âà†Èô§Â≠óÁ¨¶Êï∞**ÔºöÂêëÂêéÂà†Èô§Â§öÂ∞ë‰∏™Â≠ó„ÄÇ
*   **Áõ¥Âà∞Êú´Â∞æ**ÔºöÂãæÈÄâÂêéÔºå‰ªéËµ∑Âßã‰ΩçÁΩÆ‰∏ÄÁõ¥Âà†Âà∞ÊúÄÂêé„ÄÇ

### 3.3 ÁßªÈô§ (Remove)
Âà†Èô§ÁâπÂÆöÁöÑÊñáÂ≠óÂÜÖÂÆπ„ÄÇ
*   **ÁßªÈô§ÊñáÊú¨**ÔºöËæìÂÖ•‰Ω†ÊÉ≥Âà†ÊéâÁöÑËØçÔºà‰æãÂ¶Ç "ÂâØÊú¨"Ôºâ„ÄÇ
*   **Ê®°Âºè**Ôºö
    *   `ÂÖ®ÈÉ®`ÔºöÂà†ÊéâÂá∫Áé∞ÁöÑÊâÄÊúâËØ•ËØç„ÄÇ
    *   `È¶ñ‰∏™`ÔºöÂè™Âà†ÊéâÂá∫Áé∞ÁöÑÁ¨¨‰∏ÄÊ¨°„ÄÇ
    *   `Êú´‰∏™`ÔºöÂè™Âà†ÊéâÂá∫Áé∞ÁöÑÊúÄÂêé‰∏ÄÊ¨°„ÄÇ

### 3.4 ÊõøÊç¢ (Replace)
Â∞Ü‰∏ÄÊÆµÊñáÂ≠óÂèòÊàêÂè¶‰∏ÄÊÆµÊñáÂ≠ó„ÄÇ
*   **Êü•Êâæ**ÔºöË¶ÅË¢´Êç¢ÊéâÁöÑÊóßÊñáÂ≠ó„ÄÇ
*   **ÊõøÊç¢‰∏∫**ÔºöÊñ∞ÁöÑÊñáÂ≠óÔºàÁïôÁ©∫ÂàôÁ≠âÂêå‰∫éÂà†Èô§Ôºâ„ÄÇ
*   **È´òÁ∫ßÈÄâÈ°π**Ôºö
    *   `Ê≠£ÂàôË°®ËææÂºè`ÔºöÊîØÊåÅ Regex ËØ≠Ê≥ïÔºàÈÄÇÂêàÈ´òÁ∫ßÁî®Êà∑Ôºâ„ÄÇ
    *   `Âå∫ÂàÜÂ§ßÂ∞èÂÜô`ÔºöÂãæÈÄâÂêé `A` Âíå `a` ‰ºöË¢´ËßÜ‰∏∫‰∏çÂêåÂ≠óÁ¨¶„ÄÇ

### 3.5 Â§ßÂ∞èÂÜô (Case)
Âø´ÈÄü‰øÆÊîπÂ≠óÊØçÁöÑÂ§ßÂ∞èÂÜôÊ†ºÂºè„ÄÇ
*   `ÂÖ®ÈÉ®Â∞èÂÜô`ÔºöABC -> abc
*   `ÂÖ®ÈÉ®Â§ßÂÜô`Ôºöabc -> ABC
*   `È¶ñÂ≠óÊØçÂ§ßÂÜô`Ôºöhello world -> Hello world
*   `ÊØè‰∏™ÂçïËØçÈ¶ñÂ≠óÊØçÂ§ßÂÜô`Ôºöhello world -> Hello World
*   `ÂèçËΩ¨Â§ßÂ∞èÂÜô`ÔºöaBc -> AbC

### 3.6 Â∫èÂàóÂåñ (Serialize)
ÁªôÊñá‰ª∂Ê∑ªÂä†Êï∞Â≠óÁºñÂè∑ÔºàÂ¶Ç 001, 002Ôºâ„ÄÇ
*   **Ëµ∑Âßã**ÔºöÁ¨¨‰∏Ä‰∏™Êñá‰ª∂‰ªéÂá†Âè∑ÂºÄÂßãÔºàÈªòËÆ§ 1Ôºâ„ÄÇ
*   **Â¢ûÈáè**ÔºöÊØèÊ¨°Â¢ûÂä†Â§öÂ∞ëÔºàÈªòËÆ§ 1Ôºâ„ÄÇ
*   **Â°´ÂÖÖ‰ΩçÊï∞**ÔºöÊï∞Â≠óÁöÑÈïøÂ∫¶ÔºàË°•Èõ∂Ôºâ„ÄÇ
    *   ËÆæ‰∏∫ `1` -> 1, 2, ..., 10
    *   ËÆæ‰∏∫ `3` -> 001, 002, ..., 010
*   **‰ΩçÁΩÆ**ÔºöÊ∑ªÂä†Âà∞Êñá‰ª∂ÂêçÁöÑÂºÄÂ§¥ÊàñÁªìÂ∞æ„ÄÇ

### 3.7 Êâ©Â±ïÂêç (Extension)
‰∏ìÈó®Â§ÑÁêÜÊñá‰ª∂ÁöÑÂêéÁºÄÂêç„ÄÇ
*   `Êîπ‰∏∫Â∞èÂÜô`Ôºö.JPG -> .jpg
*   `Êîπ‰∏∫Â§ßÂÜô`Ôºö.jpg -> .JPG
*   `ÁßªÈô§Êâ©Â±ïÂêç`ÔºöÊÖéÁî®ÔºåÊñá‰ª∂ÂèØËÉΩÊó†Ê≥ïÊâìÂºÄ„ÄÇ
*   `Êõ¥Êîπ‰∏∫`ÔºöËæìÂÖ•Êñ∞ÁöÑÂêéÁºÄÔºà‰æãÂ¶ÇÊää png Êîπ‰∏∫ jpgÔºâ„ÄÇ

---

## 4. È´òÁ∫ßÂäüËÉΩ‰∏éÊäÄÂ∑ß

### Ë∞ÉÊï¥ËßÑÂàôÈ°∫Â∫è
ËßÑÂàôÁöÑÊâßË°åÊòØÊúâÈ°∫Â∫èÁöÑÔºÅ
*   ‰æãÂ¶ÇÔºöÂÖà‚ÄúÊèíÂÖ•ÂâçÁºÄ‚ÄùÔºåÂÜç‚ÄúÂÖ®ÈÉ®Â§ßÂÜô‚ÄùÔºåÂâçÁºÄ‰πü‰ºöÂèòÊàêÂ§ßÂÜô„ÄÇ
*   **Êìç‰Ωú**ÔºöÂú®ËßÑÂàôÂàóË°®‰∏≠ÈÄâ‰∏≠‰∏ÄÊù°ËßÑÂàôÔºåÁÇπÂáª‰∏äÊñπÁöÑ **‚¨Ü ‰∏äÁßª** Êàñ **‚¨á ‰∏ãÁßª** ÊåâÈíÆÔºõÊàñËÄÖ**Áõ¥Êé•Áî®Èº†Ê†áÊãñÊãΩ**ËßÑÂàôË°åÊù•ÊîπÂèòÈ°∫Â∫è„ÄÇ

### ‰∏¥Êó∂Á¶ÅÁî®ËßÑÂàô
Â¶ÇÊûúÊÇ®ÊÉ≥ÊöÇÊó∂‰∏ç‰ΩøÁî®ÊüêÊù°ËßÑÂàôÔºå‰ΩÜ‰∏çÊÉ≥Âà†Èô§ÂÆÉÔºö
*   Âú®ËßÑÂàôÂàóË°®‰∏≠Ôºå**ÂèñÊ∂àÂãæÈÄâ**ËØ•ËßÑÂàôÂâçÁöÑÂ§çÈÄâÊ°Ü„ÄÇÈ¢ÑËßàÁªìÊûú‰ºöÁ´ãÂç≥Êõ¥Êñ∞„ÄÇ

### Ë∑≥ËøáÁâπÂÆöÊñá‰ª∂
Â¶ÇÊûúÊÇ®ÂØºÂÖ•‰∫Ü 10 ‰∏™Êñá‰ª∂Ôºå‰ΩÜÂè™ÊÉ≥ÊîπÂÖ∂‰∏≠ 8 ‰∏™Ôºö
*   Âú®‰∏ãÊñπÊñá‰ª∂ÂàóË°®‰∏≠Ôºå**ÂèñÊ∂àÂãæÈÄâ**‰∏çÊÉ≥Â§ÑÁêÜÁöÑÊñá‰ª∂„ÄÇËøô‰∫õÊñá‰ª∂ÁöÑÁä∂ÊÄÅ‰ºöÂèò‰∏∫ÁÅ∞Ëâ≤‚ÄúË∑≥Ëøá‚ÄùÔºåÈáçÂëΩÂêçÊó∂‰∏ç‰ºöÂèóÂΩ±Âìç„ÄÇ

### ÂøΩÁï•Êâ©Â±ïÂêç (ÈáçË¶Å)
Â§ßÂ§öÊï∞ËßÑÂàôÔºàÊèíÂÖ•„ÄÅÂà†Èô§„ÄÅÊõøÊç¢Á≠âÔºâÂ∫ïÈÉ®ÈÉΩÊúâ‰∏Ä‰∏™ **‚ÄúÂøΩÁï•Êâ©Â±ïÂêç‚Äù** ÁöÑÂ§çÈÄâÊ°ÜÔºàÈªòËÆ§ÂãæÈÄâÔºâ„ÄÇ
*   **ÂãæÈÄâÊó∂**ÔºöÊìç‰ΩúÂè™ÈíàÂØπÊñá‰ª∂Âêç‰∏ª‰ΩìÔºàÂ¶Ç `photo`ÔºâÔºå`.jpg` ‰øùÊåÅ‰∏çÂèò„ÄÇ
*   **‰∏çÂãæÈÄâÊó∂**ÔºöÊìç‰ΩúÈíàÂØπÂÆåÊï¥Êñá‰ª∂ÂêçÔºàÂ¶Ç `photo.jpg`Ôºâ„ÄÇÂ¶ÇÊûúÊÇ®ÊÉ≥Êää `.jpg` ÊõøÊç¢Êàê `.png`ÔºåËØ∑ÂèñÊ∂àÂãæÈÄâÊ≠§È°πÔºåÊàñËÄÖÁõ¥Êé•‰ΩøÁî®‚ÄúÊâ©Â±ïÂêç‚ÄùËßÑÂàô„ÄÇ

---

## 5. Â∏∏ËßÅÈóÆÈ¢ò‰∏éÊ≥®ÊÑè‰∫ãÈ°π

**Q: ‰∏∫‰ªÄ‰πàÊñá‰ª∂ÂêçÂèòÊàê‰∫ÜÁ∫¢Ëâ≤Ôºü**
A: ËøôË°®Á§∫Âá∫Áé∞‰∫ÜÈîôËØØ„ÄÇ
*   **ÂÜ≤Á™Å**ÔºöÂΩìÂâçËßÑÂàôÂØºËá¥‰∏§‰∏™‰∏çÂêåÁöÑÊñá‰ª∂ÊîπÂêçÂêéÂêçÂ≠ó‰∏ÄÊ®°‰∏ÄÊ†∑ÔºåÁ≥ªÁªüÊó†Ê≥ïÂ§ÑÁêÜ„ÄÇ
*   **Â∑≤Â≠òÂú®**ÔºöÊîπÂêçÂêéÁöÑÂêçÂ≠ó‰∏éÊñá‰ª∂Â§πÈáåÁé∞ÊúâÁöÑÂÖ∂‰ªñÊñá‰ª∂ÈáçÂêç„ÄÇ
*   **Ëß£ÂÜ≥ÊñπÊ≥ï**ÔºöÊ∑ªÂä†‰∏ÄÊù°‚ÄúÂ∫èÂàóÂåñ‚ÄùËßÑÂàôÔºåÊàñËÄÖ‰øÆÊîπÁé∞ÊúâËßÑÂàôÔºåÁ°Æ‰øùÊØè‰∏™Êñá‰ª∂ÂêçÂîØ‰∏Ä„ÄÇ

**Q: ÈáçÂëΩÂêçÂêéÂèØ‰ª•Êí§ÈîÄÂêóÔºü**
A: **‰∏çÂèØ‰ª•**„ÄÇÊñá‰ª∂ÈáçÂëΩÂêçÊòØÁõ¥Êé•ÂØπÁ≥ªÁªüÊñá‰ª∂ËøõË°åÊìç‰ΩúÔºåÊó†Ê≥ïÈÄöËøáËΩØ‰ª∂ÂÜÖÁöÑ‰∏ÄÈîÆÊí§ÈîÄÊÅ¢Â§ç„ÄÇÂª∫ËÆÆÂú®ÊâπÈáèÊìç‰ΩúÈáçË¶ÅÊñá‰ª∂ÂâçÔºåÂÖàÊãøÂ∞ëÈáèÊñá‰ª∂ËøõË°åÊµãËØï„ÄÇ

**Q: Âè™ÊúâÈÉ®ÂàÜÊñá‰ª∂ÊÉ≥ÊîπÂêçÊÄé‰πàÂäûÔºü**
A: ÂèØ‰ª•Âú®Êñá‰ª∂ÂàóË°®‰∏≠ÂèñÊ∂àÂãæÈÄâ‰∏çÈúÄË¶ÅÊîπÂêçÁöÑÊñá‰ª∂„ÄÇ

**Q: Â¶Ç‰ΩïÊ∏ÖÁ©∫ÊâÄÊúâËßÑÂàôÔºü**
A: ÈÄâ‰∏≠ËßÑÂàôÂπ∂ÁÇπÂáª‚ÄúÁßªÈô§‚ÄùÔºåÊàñËÄÖÁõ¥Êé•ÈáçÂêØËΩØ‰ª∂„ÄÇ

**‰ªìÂ∫ìÈìæÊé•**

[![Repo Name](https://github-readme-stats.vercel.app/api/pin/?username=lyc-28&repo=Renamer)](https://github.com/lyc-28/Renamer)

ÈÇ£‰πàÔºåÊú¨Ê¨°ÂàÜ‰∫´Â∞±Âà∞Ê≠§ÁªìÊùü‰∫Ü„ÄÇ

Â¶ÇÊûúÂú®‰ΩøÁî®ËøáÁ®ã‰∏≠ÂèëÁé∞ÊúâBUGËØ∑Âú®ËØÑËÆ∫Âå∫ÊåáÂá∫ÔºåÊúüÂæÖÁúãÂà∞‰Ω†ÁöÑÂª∫ËÆÆ‰∏éÂèçÈ¶àÔºÅ

‰∏ãÈù¢ÔºåÊ∫êÁ†ÅÂ±ïÁ§∫ÁéØËäÇÔºÅÔºÅÔºÅ

```python
import sys
import os
import re
from typing import List, Dict, Any

from PyQt5.QtWidgets import (
    QApplication, QMainWindow, QWidget, QVBoxLayout, QHBoxLayout,
    QTableWidget, QTableWidgetItem, QHeaderView, QPushButton, QToolBar,
    QSplitter, QFileDialog, QMessageBox, QDialog, QLineEdit, QLabel,
    QFormLayout, QCheckBox, QListWidget, QStackedWidget, QGroupBox,
    QRadioButton, QSpinBox, QButtonGroup, QStyle, QAbstractItemView, QFrame
)
from PyQt5.QtCore import Qt, QSize
from PyQt5.QtGui import (
    QFont, QColor, QPainter, QDragEnterEvent, QDragMoveEvent,
    QDropEvent
)

# ==========================================
# 1. Ê†∑ÂºèË°® (‰øùÊåÅÁªèÂÖ∏È£éÊ†º)
# ==========================================
STYLESHEET = """
QWidget {
    font-family: "Microsoft YaHei", "Segoe UI";
    font-size: 9pt;
    color: #000000;
}
QMainWindow {
    background-color: #f0f0f0;
}
QToolBar {
    background-color: #f9f9f9;
    border-bottom: 1px solid #c0c0c0;
    spacing: 5px;
    padding: 4px;
}
QToolButton {
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 2px;
    padding: 3px 8px;
    color: #333;
    font-weight: normal;
}
QToolButton:hover {
    background-color: #e5f3ff;
    border: 1px solid #cce8ff;
}
QTableWidget {
    background-color: #ffffff;
    border: 1px solid #828790;
    gridline-color: #e0e0e0;
    selection-background-color: #3399ff;
    selection-color: white;
}
QHeaderView::section {
    background-color: #f0f0f0;
    padding: 3px;
    border: 1px solid #d0d0d0;
    border-left: none;
    border-top: none;
    font-weight: normal;
}
QSplitter::handle {
    background-color: #d0d0d0;
    height: 3px;
}
QFrame#RuleBar {
    background-color: #fcfcfc;
    border-bottom: 1px solid #a0a0a0;
}
QStatusBar {
    background-color: #f0f0f0;
    border-top: 1px solid #c0c0c0;
}
"""


# ==========================================
# 2. ËßÑÂàôÈÄªËæëÁªÑ‰ª∂
# ==========================================
class BaseRuleWidget(QWidget):
    def __init__(self):
        super().__init__()
        self.layout = QVBoxLayout(self)
        self.layout.setContentsMargins(10, 10, 10, 10)
        self.setup_ui()
        self.layout.addStretch()

    def setup_ui(self):
        pass

    def get_config(self) -> Dict[str, Any]:
        return {}


class InsertRuleWidget(BaseRuleWidget):
    def setup_ui(self):
        form = QFormLayout()
        self.txt = QLineEdit()
        form.addRow("ÊèíÂÖ•ÂÜÖÂÆπ:", self.txt)
        self.layout.addLayout(form)

        gb = QGroupBox("‰ΩçÁΩÆ")
        vbox = QVBoxLayout()
        self.bg = QButtonGroup(self)

        self.rb1 = QRadioButton("ÂâçÁºÄ (ÂºÄÂ§¥)")
        self.bg.addButton(self.rb1, 0)

        self.rb2 = QRadioButton("ÂêéÁºÄ (Êú´Â∞æ)")
        self.bg.addButton(self.rb2, 1)

        self.rb3 = QRadioButton("ÊåáÂÆö‰ΩçÁΩÆ")
        self.bg.addButton(self.rb3, 2)

        self.spin = QSpinBox()
        self.spin.setEnabled(False)
        self.rb3.toggled.connect(self.spin.setEnabled)
        self.rb1.setChecked(True)

        h = QHBoxLayout()
        h.addWidget(self.rb3)
        h.addWidget(self.spin)

        vbox.addWidget(self.rb1)
        vbox.addWidget(self.rb2)
        vbox.addLayout(h)

        gb.setLayout(vbox)
        self.layout.addWidget(gb)

        self.chk = QCheckBox("ÂøΩÁï•Êâ©Â±ïÂêç")
        self.chk.setChecked(True)
        self.layout.addWidget(self.chk)

    def get_config(self) -> Dict[str, Any]:
        m = "prefix"
        if self.bg.checkedId() == 1:
            m = "suffix"
        elif self.bg.checkedId() == 2:
            m = "pos"
        return {
            'type': 'Insert',
            'text': self.txt.text(),
            'mode': m,
            'pos': self.spin.value(),
            'ign': self.chk.isChecked(),
            'desc': f"ÊèíÂÖ• '{self.txt.text()}'"
        }


class DeleteRuleWidget(BaseRuleWidget):
    def setup_ui(self):
        form = QFormLayout()
        self.s = QSpinBox()
        self.s.setRange(1, 9999)
        self.c = QSpinBox()
        self.c.setRange(1, 9999)
        self.e = QCheckBox("Áõ¥Âà∞Êú´Â∞æ")
        self.e.toggled.connect(lambda x: self.c.setDisabled(x))

        form.addRow("Ëµ∑Âßã‰ΩçÁΩÆ:", self.s)
        form.addRow("Âà†Èô§Â≠óÁ¨¶Êï∞:", self.c)
        form.addRow("", self.e)

        self.layout.addLayout(form)
        self.chk = QCheckBox("ÂøΩÁï•Êâ©Â±ïÂêç")
        self.chk.setChecked(True)
        self.layout.addWidget(self.chk)

    def get_config(self) -> Dict[str, Any]:
        desc = f"Âà†Èô§ ‰ΩçÁΩÆ {self.s.value()} " + ("Áõ¥Âà∞Êú´Â∞æ" if self.e.isChecked() else f"ÂÖ± {self.c.value()} ‰∏™")
        return {
            'type': 'Delete',
            'start': self.s.value(),
            'count': self.c.value(),
            'end': self.e.isChecked(),
            'ign': self.chk.isChecked(),
            'desc': desc
        }


class RemoveRuleWidget(BaseRuleWidget):
    def setup_ui(self):
        form = QFormLayout()
        self.txt = QLineEdit()
        form.addRow("ÁßªÈô§ÊñáÊú¨:", self.txt)
        self.layout.addLayout(form)

        self.bg = QButtonGroup(self)
        self.rb1 = QRadioButton("ÂÖ®ÈÉ®")
        self.rb1.setChecked(True)
        self.bg.addButton(self.rb1, 0)

        self.rb2 = QRadioButton("È¶ñ‰∏™")
        self.bg.addButton(self.rb2, 1)

        self.rb3 = QRadioButton("Êú´‰∏™")
        self.bg.addButton(self.rb3, 2)

        h = QHBoxLayout()
        h.addWidget(self.rb1)
        h.addWidget(self.rb2)
        h.addWidget(self.rb3)
        self.layout.addLayout(h)

        self.chk = QCheckBox("ÂøΩÁï•Êâ©Â±ïÂêç")
        self.chk.setChecked(True)
        self.layout.addWidget(self.chk)

    def get_config(self) -> Dict[str, Any]:
        m = ['all', 'first', 'last'][self.bg.checkedId()]
        return {
            'type': 'Remove',
            'text': self.txt.text(),
            'mode': m,
            'ign': self.chk.isChecked(),
            'desc': f"ÁßªÈô§ '{self.txt.text()}'"
        }


class ReplaceRuleWidget(BaseRuleWidget):
    def setup_ui(self):
        form = QFormLayout()
        self.f = QLineEdit()
        self.r = QLineEdit()
        form.addRow("Êü•Êâæ:", self.f)
        form.addRow("ÊõøÊç¢‰∏∫:", self.r)
        self.layout.addLayout(form)

        self.regex = QCheckBox("Ê≠£ÂàôË°®ËææÂºè")
        self.case = QCheckBox("Âå∫ÂàÜÂ§ßÂ∞èÂÜô")
        self.layout.addWidget(self.regex)
        self.layout.addWidget(self.case)

        self.chk = QCheckBox("ÂøΩÁï•Êâ©Â±ïÂêç")
        self.chk.setChecked(True)
        self.layout.addWidget(self.chk)

    def get_config(self) -> Dict[str, Any]:
        return {
            'type': 'Replace',
            'find': self.f.text(),
            'rep': self.r.text(),
            'reg': self.regex.isChecked(),
            'case': self.case.isChecked(),
            'ign': self.chk.isChecked(),
            'desc': f"ÊõøÊç¢ '{self.f.text()}' -> '{self.r.text()}'"
        }


class CaseRuleWidget(BaseRuleWidget):
    def setup_ui(self):
        self.bg = QButtonGroup(self)
        opts = ["ÂÖ®ÈÉ®Â∞èÂÜô", "ÂÖ®ÈÉ®Â§ßÂÜô", "È¶ñÂ≠óÊØçÂ§ßÂÜô", "ÊØè‰∏™ÂçïËØçÈ¶ñÂ≠óÊØçÂ§ßÂÜô", "ÂèçËΩ¨Â§ßÂ∞èÂÜô"]
        for i, t in enumerate(opts):
            r = QRadioButton(t)
            if i == 0:
                r.setChecked(True)
            self.bg.addButton(r, i)
            self.layout.addWidget(r)

        self.chk = QCheckBox("ÂøΩÁï•Êâ©Â±ïÂêç")
        self.chk.setChecked(True)
        self.layout.addWidget(self.chk)

    def get_config(self) -> Dict[str, Any]:
        m = ['lower', 'upper', 'cap', 'title', 'swap'][self.bg.checkedId()]
        return {
            'type': 'Case',
            'mode': m,
            'ign': self.chk.isChecked(),
            'desc': f"Â§ßÂ∞èÂÜô: {m}"
        }


class SerializeRuleWidget(BaseRuleWidget):
    def setup_ui(self):
        form = QFormLayout()
        self.idx = QSpinBox()
        self.idx.setRange(0, 99999)
        self.idx.setValue(1)
        self.stp = QSpinBox()
        self.stp.setValue(1)
        self.pad = QSpinBox()
        self.pad.setValue(1)
        form.addRow("Ëµ∑Âßã:", self.idx)
        form.addRow("Â¢ûÈáè:", self.stp)
        form.addRow("Â°´ÂÖÖ‰ΩçÊï∞:", self.pad)
        self.layout.addLayout(form)

        self.bg = QButtonGroup(self)
        self.rb1 = QRadioButton("ÂêéÁºÄ")
        self.rb1.setChecked(True)
        self.bg.addButton(self.rb1, 0)

        self.rb2 = QRadioButton("ÂâçÁºÄ")
        self.bg.addButton(self.rb2, 1)

        h = QHBoxLayout()
        h.addWidget(self.rb1)
        h.addWidget(self.rb2)
        self.layout.addLayout(h)

        self.chk = QCheckBox("ÂøΩÁï•Êâ©Â±ïÂêç")
        self.chk.setChecked(True)
        self.layout.addWidget(self.chk)

    def get_config(self) -> Dict[str, Any]:
        return {
            'type': 'Serialize',
            'idx': self.idx.value(),
            'stp': self.stp.value(),
            'pad': self.pad.value(),
            'loc': 'end' if self.bg.checkedId() == 0 else 'start',
            'ign': self.chk.isChecked(),
            'desc': "Ê∑ªÂä†Â∫èÂàóÂè∑"
        }


class ExtRuleWidget(BaseRuleWidget):
    def setup_ui(self):
        self.bg = QButtonGroup(self)

        self.rb1 = QRadioButton("Êîπ‰∏∫Â∞èÂÜô")
        self.rb1.setChecked(True)
        self.bg.addButton(self.rb1, 0)

        self.rb2 = QRadioButton("Êîπ‰∏∫Â§ßÂÜô")
        self.bg.addButton(self.rb2, 1)

        self.rb3 = QRadioButton("ÁßªÈô§Êâ©Â±ïÂêç")
        self.bg.addButton(self.rb3, 2)

        self.layout.addWidget(self.rb1)
        self.layout.addWidget(self.rb2)
        self.layout.addWidget(self.rb3)

        form = QFormLayout()
        self.new_ext = QLineEdit()
        self.new_ext.setPlaceholderText("‰æãÂ¶Ç: jpg")

        self.rb4 = QRadioButton("Êõ¥Êîπ‰∏∫:")
        self.bg.addButton(self.rb4, 3)
        self.rb4.toggled.connect(self.new_ext.setEnabled)
        self.new_ext.setEnabled(False)

        form.addRow(self.rb4, self.new_ext)
        self.layout.addLayout(form)

    def get_config(self) -> Dict[str, Any]:
        id = self.bg.checkedId()
        m = ['lower', 'upper', 'remove', 'change'][id]
        desc = "Êâ©Â±ïÂêç: " + ["Â∞èÂÜô", "Â§ßÂÜô", "ÁßªÈô§", f"Êîπ‰∏∫ {self.new_ext.text()}"][id]
        return {'type': 'Ext', 'mode': m, 'new': self.new_ext.text(), 'desc': desc}


class AddRuleDialog(QDialog):
    def __init__(self, parent=None):
        super().__init__(parent)
        self.setWindowTitle("Ê∑ªÂä†ËßÑÂàô")
        self.resize(550, 350)
        layout = QHBoxLayout(self)

        self.list = QListWidget()
        self.list.addItems(["ÊèíÂÖ•", "Âà†Èô§", "ÁßªÈô§", "ÊõøÊç¢", "Â§ßÂ∞èÂÜô", "Â∫èÂàóÂåñ", "Êâ©Â±ïÂêç"])
        self.list.setFixedWidth(120)

        self.stack = QStackedWidget()
        self.widgets = [
            InsertRuleWidget(), DeleteRuleWidget(), RemoveRuleWidget(),
            ReplaceRuleWidget(), CaseRuleWidget(), SerializeRuleWidget(), ExtRuleWidget()
        ]
        for w in self.widgets:
            self.stack.addWidget(w)

        self.list.currentRowChanged.connect(self.stack.setCurrentIndex)

        right_w = QWidget()
        r_layout = QVBoxLayout(right_w)
        r_layout.addWidget(QLabel("ÈÖçÁΩÆ:"))
        r_layout.addWidget(self.stack)

        btns = QHBoxLayout()
        b_ok = QPushButton("‚ûï Ê∑ªÂä†")
        b_ok.clicked.connect(self.accept)
        b_no = QPushButton("ÂèñÊ∂à")
        b_no.clicked.connect(self.reject)

        btns.addStretch()
        btns.addWidget(b_ok)
        btns.addWidget(b_no)
        r_layout.addLayout(btns)

        layout.addWidget(self.list)
        layout.addWidget(right_w)
        self.list.setCurrentRow(0)

    def get_rule(self) -> Dict[str, Any]:
        return self.stack.currentWidget().get_config()


# ==========================================
# 3. Ë°®Ê†ºÁªÑ‰ª∂ (ÊîØÊåÅÊãñÊãΩ)
# ==========================================
class RuleTable(QTableWidget):
    def __init__(self, parent):
        super().__init__(parent)
        self.setColumnCount(2)
        self.setHorizontalHeaderLabels(["ÂêØÁî®", "ËßÑÂàôËØ¥Êòé"])
        self.horizontalHeader().setStretchLastSection(True)
        self.setColumnWidth(0, 40)
        self.verticalHeader().setVisible(True)
        self.verticalHeader().setDefaultSectionSize(24)
        self.setShowGrid(False)
        self.setStyleSheet("border: none; border-top: 1px solid #a0a0a0;")
        self.setSelectionBehavior(QAbstractItemView.SelectRows)
        self.setSelectionMode(QAbstractItemView.SingleSelection)
        self.setDragEnabled(True)
        self.setAcceptDrops(True)
        self.setDragDropMode(QAbstractItemView.InternalMove)

    def dropEvent(self, event: QDropEvent):
        source_row = self.currentRow()
        target_index = self.indexAt(event.pos())
        if not target_index.isValid():
            return
        target_row = target_index.row()
        if source_row == target_row:
            return
        self.window().move_rule_drag(source_row, target_row)
        event.accept()


class FileTable(QTableWidget):
    def __init__(self, parent):
        super().__init__(parent)
        self.setColumnCount(5)  # [Checkbox, Status, NewName, OldName, Path]
        self.setHorizontalHeaderLabels(["", "Áä∂ÊÄÅ", "Êñ∞ÂêçÁß∞", "ÂéüÂêçÁß∞", "Ë∑ØÂæÑ"])
        self.setColumnWidth(0, 30)
        self.horizontalHeader().setSectionResizeMode(0, QHeaderView.Fixed)
        self.horizontalHeader().setSectionResizeMode(2, QHeaderView.Stretch)
        self.horizontalHeader().setSectionResizeMode(3, QHeaderView.Stretch)
        self.setAcceptDrops(True)
        self.setSelectionBehavior(QAbstractItemView.SelectRows)
        self.setShowGrid(False)
        self.verticalHeader().setVisible(False)
        self.verticalHeader().setDefaultSectionSize(22)

    def dragEnterEvent(self, e: QDragEnterEvent):
        if e.mimeData().hasUrls():
            e.acceptProposedAction()
        else:
            e.ignore()

    def dragMoveEvent(self, e: QDragMoveEvent):
        if e.mimeData().hasUrls():
            e.acceptProposedAction()
        else:
            e.ignore()

    def dropEvent(self, e: QDropEvent):
        if e.mimeData().hasUrls():
            files = [u.toLocalFile() for u in e.mimeData().urls()]
            self.window().add_files(files)
            e.acceptProposedAction()

    def paintEvent(self, event):
        super().paintEvent(event)
        if self.rowCount() == 0:
            p = QPainter(self.viewport())
            p.setPen(QColor(0, 0, 139))
            p.setFont(QFont("Microsoft YaHei", 20))
            p.drawText(self.viewport().rect(), Qt.AlignCenter, "ÊãñÊãΩÊñá‰ª∂Âà∞Ê≠§Â§Ñ")


# ==========================================
# 4. ‰∏ªÁ™óÂè£
# ==========================================
class MainWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        self.setWindowTitle("ReNamer")
        self.resize(850, 650)
        
        # ÊòæÂºèÂÆö‰πâ self.files ÁöÑÁ±ªÂûãÔºåËß£ÂÜ≥ IDE Ë≠¶Âëä
        self.rules: List[Dict[str, Any]] = []
        self.files: List[Dict[str, Any]] = []
        
        self.init_ui()

    def init_ui(self):
        # Â∑•ÂÖ∑Ê†è
        tb = QToolBar()
        tb.setIconSize(QSize(24, 24))
        tb.setToolButtonStyle(Qt.ToolButtonTextBesideIcon)
        self.addToolBar(tb)

        tb.addAction(self.style().standardIcon(QStyle.SP_FileIcon), "Ê∑ªÂä†Êñá‰ª∂").triggered.connect(self.browse_file)
        tb.addAction(self.style().standardIcon(QStyle.SP_DirIcon), "Ê∑ªÂä†Êñá‰ª∂Â§π").triggered.connect(self.browse_dir)
        tb.addSeparator()
        tb.addAction(self.style().standardIcon(QStyle.SP_BrowserReload), "Âà∑Êñ∞È¢ÑËßà").triggered.connect(self.refresh)

        ren_act = tb.addAction(self.style().standardIcon(QStyle.SP_DialogApplyButton), "ÈáçÂëΩÂêç")
        ren_act.triggered.connect(self.run_rename)

        splitter = QSplitter(Qt.Vertical)
        splitter.setHandleWidth(4)

        # ËßÑÂàôÂå∫
        top_w = QWidget()
        top_l = QVBoxLayout(top_w)
        top_l.setContentsMargins(0, 0, 0, 0)
        top_l.setSpacing(0)

        r_bar = QFrame()
        r_bar.setObjectName("RuleBar")
        r_box = QHBoxLayout(r_bar)
        r_box.setContentsMargins(5, 2, 5, 2)

        b_add = QPushButton("‚úö Ê∑ªÂä†")
        b_add.clicked.connect(self.add_rule)

        b_del = QPushButton("‚úñ ÁßªÈô§")
        b_del.clicked.connect(self.del_rule)

        b_up = QPushButton("‚¨Ü ‰∏äÁßª")
        b_up.clicked.connect(lambda: self.move_rule_btn(-1))

        b_dn = QPushButton("‚¨á ‰∏ãÁßª")
        b_dn.clicked.connect(lambda: self.move_rule_btn(1))

        for b in [b_add, b_del, b_up, b_dn]:
            b.setFlat(True)
            b.setStyleSheet("QPushButton:hover { background-color: #e0e0e0; }")
            r_box.addWidget(b)
        r_box.addStretch()

        self.rule_table = RuleTable(self)
        self.rule_table.cellChanged.connect(self.refresh)
        top_l.addWidget(r_bar)
        top_l.addWidget(self.rule_table)
        splitter.addWidget(top_w)

        # Êñá‰ª∂Âå∫
        bot_w = QWidget()
        bot_l = QVBoxLayout(bot_w)
        bot_l.setContentsMargins(0, 0, 0, 0)
        bot_l.setSpacing(0)

        self.file_table = FileTable(self)
        self.file_table.itemChanged.connect(self.on_item_change)

        bot_l.addWidget(self.file_table)
        splitter.addWidget(bot_w)

        self.setCentralWidget(splitter)
        self.status = QLabel(" 0 ‰∏™Êñá‰ª∂")
        self.statusBar().addWidget(self.status)

    # --- ÈÄªËæë ---

    def add_rule(self):
        d = AddRuleDialog(self)
        if d.exec_() == QDialog.Accepted:
            self.rules.append(d.get_rule())
            self.refresh_rules()

    def del_rule(self):
        r = self.rule_table.currentRow()
        if r >= 0:
            del self.rules[r]
            self.refresh_rules()

    def move_rule_btn(self, d):
        r = self.rule_table.currentRow()
        self.move_rule_drag(r, r + d)
        if 0 <= r + d < len(self.rules):
            self.rule_table.selectRow(r + d)

    def move_rule_drag(self, src, dst):
        if 0 <= src < len(self.rules) and 0 <= dst < len(self.rules):
            item = self.rules.pop(src)
            self.rules.insert(dst, item)
            self.refresh_rules()

    def refresh_rules(self):
        self.rule_table.blockSignals(True)
        self.rule_table.setRowCount(0)
        for i, r in enumerate(self.rules):
            self.rule_table.insertRow(i)
            it1 = QTableWidgetItem(r['type'])
            it1.setCheckState(Qt.Checked)
            it1.setFlags(
                Qt.ItemIsUserCheckable | Qt.ItemIsEnabled | Qt.ItemIsSelectable |
                Qt.ItemIsDragEnabled | Qt.ItemIsDropEnabled
            )

            it2 = QTableWidgetItem(r['desc'])
            it2.setForeground(QColor("#003399"))
            it2.setFlags(
                Qt.ItemIsEnabled | Qt.ItemIsSelectable |
                Qt.ItemIsDragEnabled | Qt.ItemIsDropEnabled
            )

            self.rule_table.setItem(i, 0, it1)
            self.rule_table.setItem(i, 1, it2)
        self.rule_table.blockSignals(False)
        self.refresh()

    def browse_file(self):
        fs, _ = QFileDialog.getOpenFileNames(self, "ÈÄâÊã©Êñá‰ª∂")
        self.add_files(fs)

    def browse_dir(self):
        d = QFileDialog.getExistingDirectory(self, "ÈÄâÊã©Êñá‰ª∂Â§π")
        if d:
            fs = [os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))]
            self.add_files(fs)

    def add_files(self, paths):
        for p in paths:
            if not any(x['path'] == p for x in self.files):
                n = os.path.basename(p)
                self.files.append({'path': p, 'orig': n, 'new': n, 'stat': 'Á≠âÂæÖ', 'checked': True})
        self.refresh()

    def on_item_change(self, item):
        row = item.row()
        col = item.column()
        # Á±ªÂûãÊ≥®Ëß£Â∏ÆÂä© IDE ËØÜÂà´ self.files ÁªìÊûÑ
        if col == 0 and row < len(self.files):
            is_checked = (item.checkState() == Qt.Checked)
            if self.files[row]['checked'] != is_checked:
                self.files[row]['checked'] = is_checked
                self.refresh()

    def refresh(self):
        seen = set()
        for i, f in enumerate(self.files):
            if not f['checked']:
                f['new'] = f['orig']
                f['stat'] = "Ë∑≥Ëøá"
                continue

            nm = f['orig']
            base, ext = os.path.splitext(nm)

            # Â∫îÁî®ËßÑÂàô
            for ri, r in enumerate(self.rules):
                if self.rule_table.rowCount() > ri and self.rule_table.item(ri, 0).checkState() == Qt.Checked:
                    try:
                        ign = r.get('ign', False)
                        w = base if ign else nm

                        typ = r['type']
                        if typ == 'Insert':
                            t = r['text']
                            if r['mode'] == 'prefix':
                                w = t + w
                            elif r['mode'] == 'suffix':
                                w = w + t
                            elif r['mode'] == 'pos':
                                p = min(r['pos'], len(w))
                                w = w[:p] + t + w[p:]
                        elif typ == 'Delete':
                            s = max(0, r['start'] - 1)
                            if r['end']:
                                w = w[:s]
                            else:
                                w = w[:s] + w[s + r['count']:]
                        elif typ == 'Remove':
                            t = r['text']
                            if t:
                                if r['mode'] == 'all':
                                    w = w.replace(t, '')
                                elif r['mode'] == 'first':
                                    w = w.replace(t, '', 1)
                                elif r['mode'] == 'last':
                                    if t in w:
                                        idx = w.rfind(t)
                                        w = w[:idx] + w[idx + len(t):]
                        elif typ == 'Replace':
                            f_txt = r['find']
                            if f_txt:
                                flags = 0 if r['case'] else re.IGNORECASE
                                if r['reg']:
                                    w = re.sub(f_txt, r['rep'], w, flags=flags)
                                else:
                                    w = re.sub(re.escape(f_txt), r['rep'], w, flags=flags)
                        elif typ == 'Case':
                            m = r['mode']
                            if m == 'lower':
                                w = w.lower()
                            elif m == 'upper':
                                w = w.upper()
                            elif m == 'cap':
                                w = w.capitalize()
                            elif m == 'title':
                                w = w.title()
                            elif m == 'swap':
                                w = w.swapcase()
                        elif typ == 'Serialize':
                            idx = r['idx'] + (i * r['stp'])
                            s = f"{idx:0{r['pad']}d}"
                            if r['loc'] == 'end':
                                w += s
                            else:
                                w = s + w
                        elif typ == 'Ext':
                            if r['mode'] == 'lower':
                                ext = ext.lower()
                            elif r['mode'] == 'upper':
                                ext = ext.upper()
                            elif r['mode'] == 'remove':
                                ext = ""
                            elif r['mode'] == 'change':
                                ext = "." + r['new'].lstrip('.')

                        if typ != 'Ext':
                            if ign:
                                base = w
                            else:
                                nm = w
                                base, ext = os.path.splitext(nm)
                        else:
                            pass

                    except Exception:
                        pass

            f['new'] = base + ext

            stat = "OK"
            if f['new'] == f['orig']:
                stat = "-"
            elif f['new'] in seen:
                stat = "ÂÜ≤Á™Å"
            elif os.path.exists(os.path.join(os.path.dirname(f['path']), f['new'])):
                stat = "Â∑≤Â≠òÂú®"
            f['stat'] = stat
            if stat != "-":
                seen.add(f['new'])

        self.update_file_ui()

    def update_file_ui(self):
        self.file_table.blockSignals(True)
        self.file_table.setRowCount(0)
        for i, f in enumerate(self.files):
            self.file_table.insertRow(i)

            # 1. Â§çÈÄâÊ°Ü
            item_chk = QTableWidgetItem()
            item_chk.setFlags(Qt.ItemIsUserCheckable | Qt.ItemIsEnabled | Qt.ItemIsSelectable)
            item_chk.setCheckState(Qt.Checked if f['checked'] else Qt.Unchecked)
            self.file_table.setItem(i, 0, item_chk)

            # 2. Áä∂ÊÄÅ
            c_stat = QColor("black")
            if f['stat'] in ["ÂÜ≤Á™Å", "Â∑≤Â≠òÂú®"]:
                c_stat = QColor("red")
            elif f['stat'] == "Ë∑≥Ëøá":
                c_stat = QColor("gray")

            it_s = QTableWidgetItem(f['stat'])
            it_s.setForeground(c_stat)
            self.file_table.setItem(i, 1, it_s)

            # 3. Êñ∞ÂêçÁß∞
            it_n = QTableWidgetItem(f['new'])
            if f['new'] != f['orig']:
                it_n.setForeground(QColor("blue"))
            if not f['checked']:
                it_n.setForeground(QColor("gray"))
            self.file_table.setItem(i, 2, it_n)

            self.file_table.setItem(i, 3, QTableWidgetItem(f['orig']))
            self.file_table.setItem(i, 4, QTableWidgetItem(f['path']))

        self.status.setText(f" {len(self.files)} ‰∏™Êñá‰ª∂")
        self.file_table.viewport().update()
        self.file_table.blockSignals(False)

    def run_rename(self):
        if any(f['stat'] in ["ÂÜ≤Á™Å", "Â∑≤Â≠òÂú®"] and f['checked'] for f in self.files):
            QMessageBox.warning(self, "Ë≠¶Âëä", "Â≠òÂú®ÂëΩÂêçÂÜ≤Á™ÅÔºåËØ∑Ê£ÄÊü•Á∫¢Ëâ≤Ê†áËÆ∞ÔºÅ")
            return
        c = 0
        for f in self.files:
            if f['checked'] and f['new'] != f['orig']:
                try:
                    d = os.path.dirname(f['path'])
                    np = os.path.join(d, f['new'])
                    os.rename(f['path'], np)
                    f['orig'] = f['new']
                    f['path'] = np
                    c += 1
                except Exception:
                    pass
        self.refresh()
        QMessageBox.information(self, "ÂÆåÊàê", f"ÈáçÂëΩÂêç {c} ‰∏™Êñá‰ª∂")


if __name__ == '__main__':
    app = QApplication(sys.argv)
    app.setStyleSheet(STYLESHEET)
    w = MainWindow()
    w.show()
    sys.exit(app.exec_())
```